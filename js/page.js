(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var loadScripts=require("./load-scripts"),polyfillsNeeded=[];window.Promise||polyfillsNeeded.push("js/promise-polyfill.js"),window.fetch||polyfillsNeeded.push("js/fetch.js"),/(iPhone|iPad);/.test(navigator.userAgent)&&polyfillsNeeded.push("js/fastclick.js"),loadScripts(polyfillsNeeded,function(){new(require("./controller"))},function(){console.error("Failed to load polyfills")});


},{"./controller":15,"./load-scripts":16}],2:[function(require,module,exports){
function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!isNumber(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,n,s,i,r,o;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],isUndefined(n))return!1;if(isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];n.apply(this,i)}else if(isObject(n)){for(s=arguments.length,i=new Array(s-1),r=1;s>r;r++)i[r-1]=arguments[r];for(o=n.slice(),s=o.length,r=0;s>r;r++)o[r].apply(this,i)}return!0},EventEmitter.prototype.addListener=function(e,t){var n;if(!isFunction(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned){var n;n=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function n(){this.removeListener(e,n),s||(s=!0,t.apply(this,arguments))}if(!isFunction(t))throw TypeError("listener must be a function");var s=!1;return n.listener=t,this.on(e,n),this},EventEmitter.prototype.removeListener=function(e,t){var n,s,i,r;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,s=-1,n===t||isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(n)){for(r=i;r-->0;)if(n[r]===t||n[r].listener&&n[r].listener===t){s=r;break}if(0>s)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(s,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],isFunction(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?isFunction(e._events[t])?1:e._events[t].length:0};


},{}],3:[function(require,module,exports){
var now=require("date-now");module.exports=function(n,u,t){function e(){var p=now()-a;u>p&&p>0?r=setTimeout(e,u-p):(r=null,t||(i=n.apply(o,l),r||(o=l=null)))}var r,l,o,a,i;return null==u&&(u=100),function(){o=this,l=arguments,a=now();var p=t&&!r;return r||(r=setTimeout(e,u)),p&&(i=n.apply(o,l),o=l=null),i}};


},{"date-now":4}],4:[function(require,module,exports){
function now(){return(new Date).getTime()}module.exports=Date.now||now;


},{}],5:[function(require,module,exports){
(function (global){
"use strict";function create(){var e=new base.HandlebarsEnvironment;return Utils.extend(e,base),e.SafeString=_SafeString2["default"],e.Exception=_Exception2["default"],e.Utils=Utils,e.escapeExpression=Utils.escapeExpression,e.VM=runtime,e.template=function(r){return runtime.template(r,e)},e}var _interopRequireWildcard=function(e){return e&&e.__esModule?e:{"default":e}};exports.__esModule=!0;var _import=require("./handlebars/base"),base=_interopRequireWildcard(_import),_SafeString=require("./handlebars/safe-string"),_SafeString2=_interopRequireWildcard(_SafeString),_Exception=require("./handlebars/exception"),_Exception2=_interopRequireWildcard(_Exception),_import2=require("./handlebars/utils"),Utils=_interopRequireWildcard(_import2),_import3=require("./handlebars/runtime"),runtime=_interopRequireWildcard(_import3),Handlebars=create();Handlebars.create=create;var root="undefined"!=typeof global?global:window,$Handlebars=root.Handlebars;Handlebars.noConflict=function(){root.Handlebars===Handlebars&&(root.Handlebars=$Handlebars)},Handlebars["default"]=Handlebars,exports["default"]=Handlebars,module.exports=exports["default"];


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./handlebars/base":6,"./handlebars/exception":7,"./handlebars/runtime":8,"./handlebars/safe-string":9,"./handlebars/utils":10}],6:[function(require,module,exports){
"use strict";function HandlebarsEnvironment(e,t){this.helpers=e||{},this.partials=t||{},registerDefaultHelpers(this)}function registerDefaultHelpers(e){e.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new _Exception2["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),e.registerHelper("blockHelperMissing",function(t,r){var i=r.inverse,n=r.fn;if(t===!0)return n(this);if(t===!1||null==t)return i(this);if(isArray(t))return t.length>0?(r.ids&&(r.ids=[r.name]),e.helpers.each(t,r)):i(this);if(r.data&&r.ids){var a=createFrame(r.data);a.contextPath=Utils.appendContextPath(r.data.contextPath,r.name),r={data:a}}return n(t,r)}),e.registerHelper("each",function(e,t){function r(t,r,n){l&&(l.key=t,l.index=r,l.first=0===r,l.last=!!n,o&&(l.contextPath=o+t)),s+=i(e[t],{data:l,blockParams:Utils.blockParams([e[t],t],[o+t,null])})}if(!t)throw new _Exception2["default"]("Must pass iterator to #each");var i=t.fn,n=t.inverse,a=0,s="",l=void 0,o=void 0;if(t.data&&t.ids&&(o=Utils.appendContextPath(t.data.contextPath,t.ids[0])+"."),isFunction(e)&&(e=e.call(this)),t.data&&(l=createFrame(t.data)),e&&"object"==typeof e)if(isArray(e))for(var c=e.length;c>a;a++)r(a,a,a===e.length-1);else{var p=void 0;for(var u in e)e.hasOwnProperty(u)&&(p&&r(p,a-1),p=u,a++);p&&r(p,a-1,!0)}return 0===a&&(s=n(this)),s}),e.registerHelper("if",function(e,t){return isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||Utils.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,r){return e.helpers["if"].call(this,t,{fn:r.inverse,inverse:r.fn,hash:r.hash})}),e.registerHelper("with",function(e,t){isFunction(e)&&(e=e.call(this));var r=t.fn;if(Utils.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var i=createFrame(t.data);i.contextPath=Utils.appendContextPath(t.data.contextPath,t.ids[0]),t={data:i}}return r(e,t)}),e.registerHelper("log",function(t,r){var i=r.data&&null!=r.data.level?parseInt(r.data.level,10):1;e.log(i,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}function createFrame(e){var t=Utils.extend({},e);return t._parent=e,t}var _interopRequireWildcard=function(e){return e&&e.__esModule?e:{"default":e}};exports.__esModule=!0,exports.HandlebarsEnvironment=HandlebarsEnvironment,exports.createFrame=createFrame;var _import=require("./utils"),Utils=_interopRequireWildcard(_import),_Exception=require("./exception"),_Exception2=_interopRequireWildcard(_Exception),VERSION="3.0.1";exports.VERSION=VERSION;var COMPILER_REVISION=6;exports.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};exports.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType="[object Object]";HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function(e,t){if(toString.call(e)===objectType){if(t)throw new _Exception2["default"]("Arg not supported with multiple helpers");Utils.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(toString.call(e)===objectType)Utils.extend(this.partials,e);else{if("undefined"==typeof t)throw new _Exception2["default"]("Attempting to register a partial as undefined");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var logger={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if("undefined"!=typeof console&&logger.level<=e){var r=logger.methodMap[e];(console[r]||console.log).call(console,t)}}};exports.logger=logger;var log=logger.log;exports.log=log;


},{"./exception":7,"./utils":10}],7:[function(require,module,exports){
"use strict";function Exception(r,e){var o=e&&e.loc,t=void 0,s=void 0;o&&(t=o.start.line,s=o.start.column,r+=" - "+t+":"+s);for(var c=Error.prototype.constructor.call(this,r),i=0;i<errorProps.length;i++)this[errorProps[i]]=c[errorProps[i]];Error.captureStackTrace&&Error.captureStackTrace(this,Exception),o&&(this.lineNumber=t,this.column=s)}exports.__esModule=!0;var errorProps=["description","fileName","lineNumber","message","name","number","stack"];Exception.prototype=new Error,exports["default"]=Exception,module.exports=exports["default"];


},{}],8:[function(require,module,exports){
"use strict";function checkRevision(e){var r=e&&e[0]||1,t=_COMPILER_REVISION$REVISION_CHANGES$createFrame.COMPILER_REVISION;if(r!==t){if(t>r){var a=_COMPILER_REVISION$REVISION_CHANGES$createFrame.REVISION_CHANGES[t],n=_COMPILER_REVISION$REVISION_CHANGES$createFrame.REVISION_CHANGES[r];throw new _Exception2["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+a+") or downgrade your runtime to an older version ("+n+").")}throw new _Exception2["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function template(e,r){function t(t,a,n){n.hash&&(a=Utils.extend({},a,n.hash)),t=r.VM.resolvePartial.call(this,t,a,n);var i=r.VM.invokePartial.call(this,t,a,n);if(null==i&&r.compile&&(n.partials[n.name]=r.compile(t,e.compilerOptions,r),i=n.partials[n.name](a,n)),null!=i){if(n.indent){for(var o=i.split("\n"),l=0,p=o.length;p>l&&(o[l]||l+1!==p);l++)o[l]=n.indent+o[l];i=o.join("\n")}return i}throw new _Exception2["default"]("The partial "+n.name+" could not be compiled when running in runtime-only mode")}function a(r){var t=void 0===arguments[1]?{}:arguments[1],i=t.data;a._setup(t),!t.partial&&e.useData&&(i=initData(r,i));var o=void 0,l=e.useBlockParams?[]:void 0;return e.useDepths&&(o=t.depths?[r].concat(t.depths):[r]),e.main.call(n,r,n.helpers,n.partials,i,l,o)}if(!r)throw new _Exception2["default"]("No environment passed to template");if(!e||!e.main)throw new _Exception2["default"]("Unknown template object: "+typeof e);r.VM.checkRevision(e.compiler);var n={strict:function(e,r){if(!(r in e))throw new _Exception2["default"]('"'+r+'" not defined in '+e);return e[r]},lookup:function(e,r){for(var t=e.length,a=0;t>a;a++)if(e[a]&&null!=e[a][r])return e[a][r]},lambda:function(e,r){return"function"==typeof e?e.call(r):e},escapeExpression:Utils.escapeExpression,invokePartial:t,fn:function(r){return e[r]},programs:[],program:function(e,r,t,a,n){var i=this.programs[e],o=this.fn(e);return r||n||a||t?i=wrapProgram(this,e,o,r,t,a,n):i||(i=this.programs[e]=wrapProgram(this,e,o)),i},data:function(e,r){for(;e&&r--;)e=e._parent;return e},merge:function(e,r){var t=e||r;return e&&r&&e!==r&&(t=Utils.extend({},r,e)),t},noop:r.VM.noop,compilerInfo:e.compiler};return a.isTop=!0,a._setup=function(t){t.partial?(n.helpers=t.helpers,n.partials=t.partials):(n.helpers=n.merge(t.helpers,r.helpers),e.usePartial&&(n.partials=n.merge(t.partials,r.partials)))},a._child=function(r,t,a,i){if(e.useBlockParams&&!a)throw new _Exception2["default"]("must pass block params");if(e.useDepths&&!i)throw new _Exception2["default"]("must pass parent depths");return wrapProgram(n,r,e[r],t,0,a,i)},a}function wrapProgram(e,r,t,a,n,i,o){function l(r){var n=void 0===arguments[1]?{}:arguments[1];return t.call(e,r,e.helpers,e.partials,n.data||a,i&&[n.blockParams].concat(i),o&&[r].concat(o))}return l.program=r,l.depth=o?o.length:0,l.blockParams=n||0,l}function resolvePartial(e,r,t){return e?e.call||t.name||(t.name=e,e=t.partials[e]):e=t.partials[t.name],e}function invokePartial(e,r,t){if(t.partial=!0,void 0===e)throw new _Exception2["default"]("The partial "+t.name+" could not be found");return e instanceof Function?e(r,t):void 0}function noop(){return""}function initData(e,r){return r&&"root"in r||(r=r?_COMPILER_REVISION$REVISION_CHANGES$createFrame.createFrame(r):{},r.root=e),r}var _interopRequireWildcard=function(e){return e&&e.__esModule?e:{"default":e}};exports.__esModule=!0,exports.checkRevision=checkRevision,exports.template=template,exports.wrapProgram=wrapProgram,exports.resolvePartial=resolvePartial,exports.invokePartial=invokePartial,exports.noop=noop;var _import=require("./utils"),Utils=_interopRequireWildcard(_import),_Exception=require("./exception"),_Exception2=_interopRequireWildcard(_Exception),_COMPILER_REVISION$REVISION_CHANGES$createFrame=require("./base");


},{"./base":6,"./exception":7,"./utils":10}],9:[function(require,module,exports){
"use strict";function SafeString(t){this.string=t}exports.__esModule=!0,SafeString.prototype.toString=SafeString.prototype.toHTML=function(){return""+this.string},exports["default"]=SafeString,module.exports=exports["default"];


},{}],10:[function(require,module,exports){
"use strict";function escapeChar(t){return escape[t]}function extend(t){for(var r=1;r<arguments.length;r++)for(var n in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],n)&&(t[n]=arguments[r][n]);return t}function indexOf(t,r){for(var n=0,e=t.length;e>n;n++)if(t[n]===r)return n;return-1}function escapeExpression(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return possible.test(t)?t.replace(badChars,escapeChar):t}function isEmpty(t){return t||0===t?isArray(t)&&0===t.length?!0:!1:!0}function blockParams(t,r){return t.path=r,t}function appendContextPath(t,r){return(t?t+".":"")+r}exports.__esModule=!0,exports.extend=extend,exports.indexOf=indexOf,exports.escapeExpression=escapeExpression,exports.isEmpty=isEmpty,exports.blockParams=blockParams,exports.appendContextPath=appendContextPath;var escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},badChars=/[&<>"'`]/g,possible=/[&<>"'`]/,toString=Object.prototype.toString;exports.toString=toString;var isFunction=function(t){return"function"==typeof t};isFunction(/x/)&&(exports.isFunction=isFunction=function(t){return"function"==typeof t&&"[object Function]"===toString.call(t)});var isFunction;exports.isFunction=isFunction;var isArray=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===toString.call(t):!1};exports.isArray=isArray;


},{}],11:[function(require,module,exports){
module.exports=require("./dist/cjs/handlebars.runtime")["default"];


},{"./dist/cjs/handlebars.runtime":5}],12:[function(require,module,exports){
module.exports=require("handlebars/runtime")["default"];


},{"handlebars/runtime":11}],13:[function(require,module,exports){
(function (global){
!function(t){"use strict";function r(t,r,e,o){var i=Object.create((r||n).prototype);return i._invoke=a(t,e||null,new f(o||[])),i}function e(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(n){return{type:"throw",arg:n}}}function n(){}function o(){}function i(){}function a(t,r,n){var o=w;return function(i,a){if(o===L)throw new Error("Generator is already running");if(o===x)return h();for(;;){var c=n.delegate;if(c){if("return"===i||"throw"===i&&c.iterator[i]===p){n.delegate=null;var u=c.iterator["return"];if(u){var l=e(u,c.iterator,a);if("throw"===l.type){i="throw",a=l.arg;continue}}if("return"===i)continue}var l=e(c.iterator[i],c.iterator,a);if("throw"===l.type){n.delegate=null,i="throw",a=l.arg;continue}i="next",a=p;var f=l.arg;if(!f.done)return o=m,f;n[c.resultName]=f.value,n.next=c.nextLoc,n.delegate=null}if("next"===i)o===m?n.sent=a:delete n.sent;else if("throw"===i){if(o===w)throw o=x,a;n.dispatchException(a)&&(i="next",a=p)}else"return"===i&&n.abrupt("return",a);o=L;var l=e(t,r,n);if("normal"===l.type){o=n.done?x:m;var f={value:l.arg,done:n.done};if(l.arg!==b)return f;n.delegate&&"next"===i&&(a=p)}else"throw"===l.type&&(o=x,i="throw",a=l.arg)}}}function c(t){E[t]=function(r){return this._invoke(t,r)}}function u(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function l(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function f(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(u,this),this.reset()}function s(t){if(t){var r=t[v];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var e=-1,n=function o(){for(;++e<t.length;)if(y.call(t,e))return o.value=t[e],o.done=!1,o;return o.value=p,o.done=!0,o};return n.next=n}}return{next:h}}function h(){return{value:p,done:!0}}var p,y=Object.prototype.hasOwnProperty,v="function"==typeof Symbol&&Symbol.iterator||"@@iterator",d="object"==typeof module,g=t.regeneratorRuntime;if(g)return void(d&&(module.exports=g));g=t.regeneratorRuntime=d?module.exports:{},g.wrap=r;var w="suspendedStart",m="suspendedYield",L="executing",x="completed",b={},E=i.prototype=n.prototype;o.prototype=E.constructor=i,i.constructor=o,o.displayName="GeneratorFunction",g.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return r?r===o||"GeneratorFunction"===(r.displayName||r.name):!1},g.mark=function(t){return t.__proto__=i,t.prototype=Object.create(E),t},g.async=function(t,n,o,i){return new Promise(function(a,c){function u(t,r){var n=e(l[t],l,r);if("throw"===n.type)return void c(n.arg);var o=n.arg;o.done?a(o.value):Promise.resolve(o.value).then(f,s)}var l=r(t,n,o,i),f=u.bind(l,"next"),s=u.bind(l,"throw");f()})},c("next"),c("throw"),c("return"),E[v]=function(){return this},E.toString=function(){return"[object Generator]"},g.keys=function(t){var r=[];for(var e in t)r.push(e);return r.reverse(),function n(){for(;r.length;){var e=r.pop();if(e in t)return n.value=e,n.done=!1,n}return n.done=!0,n}},g.values=s,f.prototype={constructor:f,reset:function(){this.prev=0,this.next=0,this.sent=p,this.done=!1,this.delegate=null,this.tryEntries.forEach(l);for(var t,r=0;y.call(this,t="t"+r)||20>r;++r)this[t]=null},stop:function(){this.done=!0;var t=this.tryEntries[0],r=t.completion;if("throw"===r.type)throw r.arg;return this.rval},dispatchException:function(t){function r(r,n){return i.type="throw",i.arg=t,e.next=r,!!n}if(this.done)throw t;for(var e=this,n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=y.call(o,"catchLoc"),c=y.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&y.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=r,o?this.next=o.finallyLoc:this.complete(i),b},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=t.arg,this.next="end"):"normal"===t.type&&r&&(this.next=r),b},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc)}},"catch":function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;l(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,e){return this.delegate={iterator:s(t),resultName:r,nextLoc:e},b}}}("object"==typeof global?global:"object"==typeof window?window:"object"==typeof self?self:this);


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],14:[function(require,module,exports){
!function(){"use strict";function t(t){return t.sort().filter(function(r,n){return JSON.stringify(r)!==JSON.stringify(t[n-1])})}function r(t){return t.filter(function(r,n){return t.indexOf(r)===n})}var n={},i=/^\d+$/;n.parse=function(r){return t(r.split(",").map(function(t){var r={};return t.trim().split(/\s+/).forEach(function(t,n){if(0===n)return r.url=t;var e=t.substring(0,t.length-1),s=t[t.length-1],u=parseInt(e,10),o=parseFloat(e);if("w"===s&&i.test(e))r.width=u;else if("h"===s&&i.test(e))r.height=u;else{if("x"!==s||isNaN(o))throw new Error("Invalid srcset descriptor: "+t+".");r.density=o}}),r}))},n.stringify=function(t){return r(t.map(function(t){if(!t.url)throw new Error("URL is required.");var r=[t.url];return t.width&&r.push(t.width+"w"),t.height&&r.push(t.height+"h"),t.density&&r.push(t.density+"x"),r.join(" ")})).join(", ")},"undefined"!=typeof module&&module.exports?module.exports=n:window.srcset=n}();


},{}],15:[function(require,module,exports){
"use strict";function processData(e,t){var r,n,a,i,s,c;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:if(r=Object.create(t),!("caches"in window)){o.next=6;break}return r.cacheCapable=!0,o.next=5,e.isCached();case 5:r.cached=o.sent;case 6:return n=r.updated,a=n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1,i=n.getDate()<10?"0"+n.getDate():n.getDate(),s=n.getHours()<10?"0"+n.getHours():n.getHours(),c=n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes(),r.updated=""+n.getFullYear()+"/"+a+"/"+i+" "+s+":"+c,o.abrupt("return",r);case 13:case"end":return o.stop()}},null,this)}var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,i=void 0;try{for(var s,c=e[Symbol.iterator]();!(n=(s=c.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(o){a=!0,i=o}finally{try{!n&&c["return"]&&c["return"]()}finally{if(a)throw i}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();require("regenerator/runtime");var debounce=require("debounce"),wikipedia=require("./wikipedia"),Controller=function(){function e(){var t=this;_classCallCheck(this,e),this._toolbarView=new(require("./views/toolbar")),this._searchResultsView=new(require("./views/search-results")),this._articleView=new(require("./views/article")),this._cachedArticlesView=new(require("./views/cached-articles")),this._toastsView=new(require("./views/toasts")),this._toolbarView.on("searchInput",function(e){return e.value?void r(e):void t._onSearchInput(e)}),this._articleView.on("cacheChange",function(e){return t._onCacheChange(e)}),this._cachedArticlesView.on("delete",function(e){return t._onDeleteCachedArticle(e)}),this._lastSearchId=0,this._article=null,"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(function(e){e.addEventListener("updatefound",function(r){return t._onUpdateFound(e)}),navigator.serviceWorker.addEventListener("controllerchange",function(e){return t._onControllerChange()}),e.waiting&&t._onUpdateReady()});var r=debounce(function(e){return t._onSearchInput(e)},150);document.body.appendChild(this._toastsView.container);var n=location.search.slice(1);n?this._loadArticle(n):this._showCachedArticles()}return _createClass(e,[{key:"_onDeleteCachedArticle",value:function(e){var t=e.id;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wikipedia.uncache(t);case 2:this._showCachedArticles();case 3:case"end":return e.stop()}},null,this)}},{key:"_onControllerChange",value:function(){location.reload()}},{key:"_onCacheChange",value:function(e){var t=this,r=e.value;return r?this._article.cache()["catch"](function(e){return t._showError(Error("Caching failed"))}):void this._article.uncache()}},{key:"_onUpdateReady",value:function(){var e,t,r;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return e=this._toastsView.show("Update available",{buttons:["reload","dismiss"]}),n.next=3,navigator.serviceWorker.getRegistration();case 3:return t=n.sent.waiting,n.next=6,e.answer;case 6:r=n.sent,"reload"==r&&t.postMessage("skipWaiting");case 8:case"end":return n.stop()}},null,this)}},{key:"_onUpdateFound",value:function(e){var t=this,r=e.installing;e.installing.addEventListener("statechange",function(e){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if("activated"!=r.state||navigator.serviceWorker.controller){e.next=3;break}return this._toastsView.show("Ready to work offline",{duration:5e3}),e.abrupt("return");case 3:"installed"==r.state&&navigator.serviceWorker.controller&&this._onUpdateReady();case 4:case"end":return e.stop()}},null,t)})}},{key:"_showCachedArticles",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wikipedia.getCachedArticleData();case 2:e.t0=e.sent,e.t1="caches"in window,this._cachedArticlesView.update({items:e.t0,cacheCapable:e.t1});case 5:case"end":return e.stop()}},null,this)}},{key:"_showError",value:function(e){this._toastsView.show(e.message,{duration:3e3})}},{key:"_onSearchInput",value:function(e){var t,r,n=e.value;return regeneratorRuntime.async(function(e){for(var a=this;;)switch(e.prev=e.next){case 0:if(t=++this._lastSearchId,n){e.next=4;break}return this._searchResultsView.hide(),e.abrupt("return");case 4:return e.prev=4,e.next=7,wikipedia.search(n);case 7:e.t2=e.sent,r={results:e.t2},e.next=14;break;case 11:e.prev=11,e.t3=e["catch"](4),r={err:"Search failed"};case 14:requestAnimationFrame(function(e){t==a._lastSearchId&&a._searchResultsView.update(r)});case 15:case"end":return e.stop()}},null,this,[[4,11]])}},{key:"_displayArticle",value:function(e){var t,r,n,a;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Promise.all([e.meta,e.html]);case 2:return t=i.sent,r=_slicedToArray(t,2),n=r[0],a=r[1],i.next=8,processData(e,n);case 8:n=i.sent,document.title=n.title+" - Offline Wikipedia",history.replaceState({},document.title,"?"+n.urlId),this._article=e,this._articleView.updateMeta(n),this._articleView.updateContent({content:a});case 14:case"end":return i.stop()}},null,this)}},{key:"_loadArticle",value:function(e){var t,r,n,a,i,s,c;return regeneratorRuntime.async(function(o){for(;;)switch(o.prev=o.next){case 0:return this._articleView.startLoading(),t=[!0,!1].map(function(t){return wikipedia.article(e,{fromCache:t})}),r=_slicedToArray(t,2),n=r[0],a=r[1],i=!1,o.prev=6,o.next=9,n;case 9:return s=o.sent,o.next=12,this._displayArticle(s);case 12:i=!0,console.log("displayed from cache"),o.next=18;break;case 16:o.prev=16,o.t4=o["catch"](6);case 18:return o.prev=18,o.next=21,a;case 21:if(c=o.sent,!i){o.next=35;break}return o.next=25,s.meta;case 25:return o.t5=o.sent.updated.valueOf(),o.next=28,c.meta;case 28:if(o.t6=o.sent.updated.valueOf(),o.t5!=o.t6){o.next=32;break}return console.log("cached version is up to date"),o.abrupt("return");case 32:return console.log("found update, caching"),o.next=35,c.cache();case 35:return o.next=37,a;case 37:return o.t7=o.sent,o.next=40,this._displayArticle(o.t7);case 40:console.log("displayed from live"),o.next=46;break;case 43:o.prev=43,o.t8=o["catch"](18),i||(this._showError(Error("Failed to load article")),this._articleView.stopLoading());case 46:case"end":return o.stop()}},null,this,[[6,16],[18,43]])}}]),e}();module.exports=Controller;


},{"./views/article":18,"./views/cached-articles":19,"./views/search-results":20,"./views/toasts":26,"./views/toolbar":27,"./wikipedia":28,"debounce":3,"regenerator/runtime":13}],16:[function(require,module,exports){
"use strict";module.exports=function(e,n,t){var o=e.length,r=!1;return 0==e.length?n():void e.forEach(function(e){var c=document.createElement("script");c.onload=function(){r||--o||n()},c.onerror=function(){r||(t(),r=!0)},c.src=e,document.head.insertBefore(c,document.head.firstChild)})};


},{}],17:[function(require,module,exports){
"use strict";function transitionClassFunc(){var n=void 0===arguments[0]?{}:arguments[0],t=n.removeClass,e=void 0===t?!1:t;return function(n){var t=void 0===arguments[1]?"active":arguments[1],r=void 0===arguments[2]?"transition":arguments[2];if(e){if(!n.classList.contains(t))return Promise.resolve()}else if(n.classList.contains(t))return Promise.resolve();return new Promise(function(s){var i=function(n){function t(t){return n.apply(this,arguments)}return t.toString=function(){return n.toString()},t}(function(t){t.target==n&&(n.removeEventListener("webkitTransitionEnd",i),n.removeEventListener("transitionend",i),n.classList.remove(r),s())});n.classList.add(r),requestAnimationFrame(function(r){n.addEventListener("webkitTransitionEnd",i),n.addEventListener("transitionend",i),n.classList[e?"remove":"add"](t)})})}}exports.toArray=function(n){return Array.prototype.slice.apply(n)},exports.domReady=new Promise(function(n){function t(){"loading"!=document.readyState&&n()}document.addEventListener("readystatechange",t),t()}),exports.strToEl=function(){var n=document.createElement("div");return function(t){var e;for(n.innerHTML=t,e=n.children[0];n.firstChild;)n.removeChild(n.firstChild);return e}}(),exports.transitionToClass=transitionClassFunc(),exports.transitionFromClass=transitionClassFunc({removeClass:!0}),exports.closest=function(n,t){if(n.closest)return n.closest(t);var e=n.matches||n.msMatchesSelector;do if(1==n.nodeType&&e.call(n,t))return n;while(n=n.parentNode);return void 0},exports.toQueryString=function(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(encodeURIComponent(e)+"="+encodeURIComponent(n[e]));return t.join("&")};


},{}],18:[function(require,module,exports){
"use strict";var _classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function e(t,n,r){var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;return void 0===o?void 0:o.call(r)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},contentTemplate=require("./templates/article-content.hbs"),headerTemplate=require("./templates/article-header.hbs"),Spinner=require("./spinner"),Article=function(e){function t(){var e=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.container=document.querySelector(".article-container"),this._content=this.container.querySelector(".article-content"),this._header=this.container.querySelector(".article-header"),this._spinner=new Spinner,this.container.appendChild(this._spinner.container),this._header.addEventListener("change",function(t){"cache"==t.target.name&&e.emit("cacheChange",{value:t.target.checked})})}return _inherits(t,e),_createClass(t,[{key:"updateContent",value:function(e){this._content.innerHTML=contentTemplate(e)}},{key:"updateMeta",value:function(e){this.stopLoading(),this._header.innerHTML=headerTemplate(e)}},{key:"startLoading",value:function(){this._spinner.show(800)}},{key:"stopLoading",value:function(){this._spinner.hide()}}]),t}(require("events").EventEmitter);module.exports=Article;


},{"./spinner":21,"./templates/article-content.hbs":22,"./templates/article-header.hbs":23,"events":2}],19:[function(require,module,exports){
"use strict";var _classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_get=function e(t,r,n){var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var c=o.get;return void 0===c?void 0:c.call(n)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},template=require("./templates/cached-articles.hbs"),CachedArticles=function(e){function t(){var e=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.container=document.querySelector(".cached-articles-container"),this.container.addEventListener("click",function(t){return e._onClick(t)})}return _inherits(t,e),_createClass(t,[{key:"_onClick",value:function(e){if(e.target.closest){var t=e.target.closest("button");t&&this.emit("delete",{id:t.value})}}},{key:"update",value:function(e){this.container.innerHTML=template(e)}}]),t}(require("events").EventEmitter);module.exports=CachedArticles;


},{"./templates/cached-articles.hbs":24,"events":2}],20:[function(require,module,exports){
"use strict";var _classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),template=require("./templates/search-results.hbs"),utils=require("../utils"),SearchResults=function(){function e(){var t=this;_classCallCheck(this,e),this.container=document.querySelector(".search-results"),this._items=[],this._activeIndex=-1,document.querySelector(".search").addEventListener("keydown",function(e){return t.onSearchKeyDown(e)})}return _createClass(e,[{key:"onSearchKeyDown",value:function(e){switch(e.keyCode){case 13:this._activate(),e.preventDefault();break;case 38:this._previous(),e.preventDefault();break;case 40:this._next(),e.preventDefault()}}},{key:"update",value:function(e){this._activeIndex=-1,this.container.classList.add("active"),this.container.innerHTML=template(e),this._items=utils.toArray(this.container.querySelectorAll(".search-result"))}},{key:"hide",value:function(){this.container.classList.remove("active")}},{key:"_previous",value:function(){this._items[this._activeIndex]&&this._items[this._activeIndex].classList.remove("active"),this._activeIndex--,this._items[this._activeIndex]||(this._activeIndex=this._items.length-1),this._items[this._activeIndex].classList.add("active")}},{key:"_next",value:function(){this._items[this._activeIndex]&&this._items[this._activeIndex].classList.remove("active"),this._activeIndex++,this._items[this._activeIndex]||(this._activeIndex=0),this._items[this._activeIndex].classList.add("active")}},{key:"_activate",value:function(){var e=this._items[this._activeIndex]||this._items[0];e&&e.querySelector("a").click()}}]),e}();module.exports=SearchResults;


},{"../utils":17,"./templates/search-results.hbs":25}],21:[function(require,module,exports){
"use strict";var _classCallCheck=function(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function i(i,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}return function(e,n,t){return n&&i(e.prototype,n),t&&i(e,t),e}}(),utils=require("../utils"),Spinner=function(){function i(){var e=this;_classCallCheck(this,i),this.container=utils.strToEl('<div class="spinner"><div class="spinner-container"><div class="spinner-layer"><div class="circle-clipper left"><div class="circle"></div></div><div class="gap-patch"><div class="circle"></div></div><div class="circle-clipper right"><div class="circle"></div></div></div></div></div>'),this._showTimeout=null,this.container.style.display="none";var n=function(i){i.target==e.container&&(e.container.style.display="none")};this.container.addEventListener("webkitAnimationEnd",n),this.container.addEventListener("animationend",n)}return _createClass(i,[{key:"show",value:function(){var i=this,e=void 0===arguments[0]?300:arguments[0];clearTimeout(this._showTimeout),this.container.style.display="none",this.container.classList.remove("cooldown"),this._showTimeout=setTimeout(function(e){i.container.style.display=""},e)}},{key:"hide",value:function(){clearTimeout(this._showTimeout),this.container.classList.add("cooldown")}}]),i}();module.exports=Spinner;


},{"../utils":17}],22:[function(require,module,exports){
var HandlebarsCompiler=require("hbsfy/runtime");module.exports=HandlebarsCompiler.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,n,t,a){var l,r;return'<div id="content_wrapper" class="content card-content">'+(null!=(r=null!=(r=n.content||(null!=e?e.content:e))?r:n.helperMissing,l="function"==typeof r?r.call(e,{name:"content",hash:{},data:a}):r)?l:"")+"</div>"},useData:!0});


},{"hbsfy/runtime":12}],23:[function(require,module,exports){
var HandlebarsCompiler=require("hbsfy/runtime");module.exports=HandlebarsCompiler.template({1:function(a,e,n,l){var t;return'  <label class="cache-toggle">\n    <input type="checkbox" name="cache"'+(null!=(t=e["if"].call(a,null!=a?a.cached:a,{name:"if",hash:{},fn:this.program(2,l,0),inverse:this.noop,data:l}))?t:"")+'>\n    <span class="material-switch">\n      <span class="track"></span>\n      <span class="handle"></span>\n    </span>\n    <span class="read-offline-txt">Read offline</span>\n  </label>\n'},2:function(a,e,n,l){return" checked"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,e,n,l){var t,s,i=e.helperMissing,c="function",p=this.escapeExpression;return'<div class="heading-text">\n  <h1>'+p((s=null!=(s=e.title||(null!=a?a.title:a))?s:i,typeof s===c?s.call(a,{name:"title",hash:{},data:l}):s))+'</h1>\n  <div class="updated-meta">- updated '+p((s=null!=(s=e.updated||(null!=a?a.updated:a))?s:i,typeof s===c?s.call(a,{name:"updated",hash:{},data:l}):s))+"</div>\n</div>\n\n"+(null!=(t=e["if"].call(a,null!=a?a.cacheCapable:a,{name:"if",hash:{},fn:this.program(1,l,0),inverse:this.noop,data:l}))?t:"")},useData:!0});


},{"hbsfy/runtime":12}],24:[function(require,module,exports){
var HandlebarsCompiler=require("hbsfy/runtime");module.exports=HandlebarsCompiler.template({1:function(n,a,e,l){var t;return null!=(t=a["if"].call(n,null!=(t=null!=n?n.items:n)?t.length:t,{name:"if",hash:{},fn:this.program(2,l,0),inverse:this.program(5,l,0),data:l}))?t:""},2:function(n,a,e,l){var t;return"        <ul> \n"+(null!=(t=a.each.call(n,null!=n?n.items:n,{name:"each",hash:{},fn:this.program(3,l,0),inverse:this.noop,data:l}))?t:"")+"        </ul>\n"},3:function(n,a,e,l){var t,r=a.helperMissing,i="function",s=this.escapeExpression;return'            <li class="item-list-item">\n              <a href="?'+s((t=null!=(t=a.urlId||(null!=n?n.urlId:n))?t:r,typeof t===i?t.call(n,{name:"urlId",hash:{},data:l}):t))+'">\n                <div class="title">'+s((t=null!=(t=a.title||(null!=n?n.title:n))?t:r,typeof t===i?t.call(n,{name:"title",hash:{},data:l}):t))+'</div>\n                <div class="description">'+s((t=null!=(t=a.extract||(null!=n?n.extract:n))?t:r,typeof t===i?t.call(n,{name:"extract",hash:{},data:l}):t))+'</div>\n              </a>\n              <button class="delete-btn" value="'+s((t=null!=(t=a.urlId||(null!=n?n.urlId:n))?t:r,typeof t===i?t.call(n,{name:"urlId",hash:{},data:l}):t))+'">\n                <svg viewBox="0 0 24 24"><title>Delete</title><path d="M6 19c0 1 1 2 2 2h8c1 0 2-1 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>\n              </button>\n            </li>\n'},5:function(n,a,e,l){return'        <p>You don\'t have anything cached yet. Maybe read about <a href="?Hulk_Hogan">Hulk Hogan</a> or something?</p>\n'},7:function(n,a,e,l){return'      <p>\n        Unfortunately your browser doesn\'t support in-page caching. Try\n        <a href="https://www.google.co.uk/chrome/browser/canary.html">Chrome Canary</a>.\n        Everything else works fine though!\n      </p>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(n,a,e,l){var t;return'<div class="subheading">\n  <div class="heading-text">\n    <h1>Cached articles</h1>\n  </div>\n</div>\n\n<div class="card">\n  <div class="card-content cached-articles">\n'+(null!=(t=a["if"].call(n,null!=n?n.cacheCapable:n,{name:"if",hash:{},fn:this.program(1,l,0),inverse:this.program(7,l,0),data:l}))?t:"")+"  </div>\n</div>"},useData:!0});


},{"hbsfy/runtime":12}],25:[function(require,module,exports){
var HandlebarsCompiler=require("hbsfy/runtime");module.exports=HandlebarsCompiler.template({1:function(e,l,n,a){var i;return"  <ol>\n"+(null!=(i=l.each.call(e,null!=e?e.results:e,{name:"each",hash:{},fn:this.program(2,a,0),inverse:this.noop,data:a}))?i:"")+"  </ol>\n"},2:function(e,l,n,a){var i,r=l.helperMissing,s="function",t=this.escapeExpression;return'      <li class="item-list-item search-result">\n        <a href="?'+t((i=null!=(i=l.id||(null!=e?e.id:e))?i:r,typeof i===s?i.call(e,{name:"id",hash:{},data:a}):i))+'">\n          <div class="title">'+t((i=null!=(i=l.title||(null!=e?e.title:e))?i:r,typeof i===s?i.call(e,{name:"title",hash:{},data:a}):i))+'</div>\n          <div class="description">'+t((i=null!=(i=l.description||(null!=e?e.description:e))?i:r,typeof i===s?i.call(e,{name:"description",hash:{},data:a}):i))+"</div>\n        </a>\n      </li>\n"},4:function(e,l,n,a){var i;return'  <div class="search-error">'+this.escapeExpression((i=null!=(i=l.err||(null!=e?e.err:e))?i:l.helperMissing,"function"==typeof i?i.call(e,{name:"err",hash:{},data:a}):i))+"</div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,l,n,a){var i;return(null!=(i=l["if"].call(e,null!=e?e.results:e,{name:"if",hash:{},fn:this.program(1,a,0),inverse:this.noop,data:a}))?i:"")+(null!=(i=l["if"].call(e,null!=e?e.err:e,{name:"if",hash:{},fn:this.program(4,a,0),inverse:this.noop,data:a}))?i:"")},useData:!0});


},{"hbsfy/runtime":12}],26:[function(require,module,exports){
"use strict";var _classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),utils=require("../utils"),Toast=function(){function t(e,n,i){var s=this;_classCallCheck(this,t),this.container=utils.strToEl('<div class="toast"><div class="toast-content"></div></div>'),this._content=this.container.querySelector(".toast-content"),this._content.textContent=e,this._answerResolve,this._hideTimeout,this.answer=new Promise(function(t){return s._answerResolve=t}),i.forEach(function(t){var e=document.createElement("button");e.className="unbutton",e.textContent=t,e.addEventListener("click",function(e){s._answerResolve(t)}),s.container.appendChild(e)}),n&&(this._hideTimeout=setTimeout(function(t){return s.hide()},n))}return _createClass(t,[{key:"hide",value:function(){return clearTimeout(this._hideTimeout),this._answerResolve(),utils.transitionToClass(this.container,"hide")}}]),t}(),Toasts=function(){function t(){_classCallCheck(this,t),this.container=utils.strToEl("<div class='toasts'></div>")}return _createClass(t,[{key:"show",value:function(t){var e=this,n=void 0===arguments[1]?{}:arguments[1],i=n.duration,s=void 0===i?0:i,o=n.buttons,r=void 0===o?["dismiss"]:o,a=new Toast(t,s,r);return this.container.appendChild(a.container),a.answer.then(function(t){return a.hide()}).then(function(t){e.container.removeChild(a.container)}),a}}]),t}();module.exports=Toasts;


},{"../utils":17}],27:[function(require,module,exports){
"use strict";var _classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_get=function e(t,r,n){var a=Object.getOwnPropertyDescriptor(t,r);if(void 0===a){var c=Object.getPrototypeOf(t);return null===c?void 0:e(c,r,n)}if("value"in a)return a.value;var i=a.get;return void 0===i?void 0:i.call(n)},_inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)},Toolbar=function(e){function t(){var e=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.container=document.querySelector(".toolbar"),this.searchBar=this.container.querySelector(".search-bar"),this.searchInput=this.container.querySelector(".search"),this.lastSearchTerm="",this.container.querySelector(".search-btn").addEventListener("click",function(t){return e.onSearchBtnClick(t)}),this.container.querySelector(".back-btn").addEventListener("click",function(t){return e.onBackBtnClick(t)}),this.searchInput.addEventListener("input",function(t){return e.onSearchInput(t)})}return _inherits(t,e),_createClass(t,[{key:"onSearchBtnClick",value:function(e){this.searchInput.value="",this.lastSearchTerm="",this.searchBar.classList.add("active"),this.searchInput.focus()}},{key:"onBackBtnClick",value:function(e){this.searchBar.classList.remove("active"),this.emit("searchInput",{value:""})}},{key:"onSearchInput",value:function(e){var t=this.searchInput.value.trim();t!=this.lastSearchTerm&&(this.lastSearchTerm=t,this.emit("searchInput",{value:t}))}}]),t}(require("events").EventEmitter);module.exports=Toolbar;


},{"events":2}],28:[function(require,module,exports){
"use strict";var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,c=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(u){a=!0,c=u}finally{try{!n&&i["return"]&&i["return"]()}finally{if(a)throw c}}return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},_classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),srcset=require("srcset"),utils=require("./utils"),base="https://wikipedia-cors.appspot.com/",apiBase=base+"en.wikipedia.org/w/api.php?",viewBase=base+"en.m.wikipedia.org/wiki/",cachePrefix="wikioffline-article-",Article=function(){function e(t,r,n,a){_classCallCheck(this,e),this._htmlRequest=t,this._htmlResponse=r,this._metaRequest=n,this._metaResponse=a,this.html=this._htmlResponse.text().then(function(e){return e.replace(/\/\/en\.wikipedia\.org\/wiki\//g,"?")}),this.meta=a.clone().json().then(function(e){var t=e.query.pages[Object.keys(e.query.pages)[0]];return{title:t.title,extract:t.extract,urlId:t.title.replace(/\s/g,"_"),updated:new Date(r.headers.get("last-modified"))}}),this._cacheName=this.meta.then(function(e){return cachePrefix+e.urlId})}return _createClass(e,[{key:"_createCacheHtmlResponse",value:function(){var e;return regeneratorRuntime.async(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.html;case 2:return e=t.sent,e=e.replace(/<img[^>]*>/gi,function(e){var t;return e=e.replace(/srcset=(['"])(.*?)\1/gi,function(e,r,n){try{var a=srcset.parse(n).sort(function(e,t){return e.density<t.density?-1:1}),c=0,s=!0,i=!1,u=void 0;try{for(var o,h=a[Symbol.iterator]();!(s=(o=h.next()).done);s=!0){var l=o.value;if(devicePixelRatio>c&&(t=l.url),devicePixelRatio<=l.density)break;c=l.density}}catch(f){i=!0,u=f}finally{try{!s&&h["return"]&&h["return"]()}finally{if(i)throw u}}}catch(p){}return""}),t&&(e=e.replace(/src=(['"]).*?\1/gi,'src="'+t+'"')),e}),t.abrupt("return",new Response(e,{headers:this._htmlResponse.headers}));case 5:case"end":return t.stop()}},null,this)}},{key:"cache",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e,t,r,n,a,c,s,i;return regeneratorRuntime.async(function(u){for(var o=this;;)switch(u.prev=u.next){case 0:return u.next=2,this.isCached();case 2:return e=u.sent,u.next=5,this._cacheName;case 5:return u.t9=u.sent,u.next=8,caches.open(u.t9);case 8:return t=u.sent,r=/<img[^>]*src=(['"])(.*?)\1[^>]*>/gi,u.next=12,this._createCacheHtmlResponse();case 12:return a=u.sent,u.next=15,a.clone().text();case 15:for(c=u.sent,s=new Set;n=r.exec(c);)s.add(n[2]);return i=[t.put(this._htmlRequest,a),t.put(this._metaRequest,this._metaResponse.clone())],s.forEach(function(e){var r=new Request(e,{mode:"no-cors"});i.push(caches.match(r).then(function(e){return e||fetch(r)}).then(function(e){return t.put(r,e)}))}),u.abrupt("return",Promise.all(i)["catch"](function(t){throw e||o.uncache(),t}));case 21:case"end":return u.stop()}},null,this)})},{key:"uncache",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._cacheName;case 2:return e.t10=e.sent,e.abrupt("return",caches["delete"](e.t10));case 4:case"end":return e.stop()}},null,this)}},{key:"isCached",value:function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._cacheName;case 2:return e.t11=e.sent,e.abrupt("return",caches.has(e.t11));case 4:case"end":return e.stop()}},null,this)}}]),e}();module.exports={search:function(e){return fetch(apiBase+utils.toQueryString({action:"opensearch",search:e,format:"json",redirects:"resolve",limit:4})).then(function(e){return e.json()}).then(function(e){var t=_slicedToArray(e,4),r=(t[0],t[1]),n=t[2],a=t[3];return r.map(function(e,t){return{title:e,description:n[t],id:/[^\/]+$/.exec(a[t])[0]}})})},_getMetaRequest:function(e){return new Request(apiBase+utils.toQueryString({action:"query",titles:e,format:"json",redirects:"resolve",prop:"extracts",explaintext:1,exsentences:1}))},article:function(e){var t=void 0===arguments[1]?{}:arguments[1],r=t.fromCache,n=void 0===r?!1:r;if(n&&!("caches"in window))return Promise.reject(Error("Caching not supported"));var a=new Request(viewBase+e+"?action=render"),c=this._getMetaRequest(e);return Promise.all([n?caches.match(a):fetch(a),n?caches.match(c):fetch(c)]).then(function(e){var t=_slicedToArray(e,2),r=t[0],n=t[1];if(!r||!n)throw Error("No response");return new Article(a,r,c,n)})},getCachedArticleData:function(){var e;return regeneratorRuntime.async(function(t){for(var r=this;;)switch(t.prev=t.next){case 0:if("caches"in window){t.next=2;break}return t.abrupt("return",[]);case 2:return t.next=4,caches.keys();case 4:return e=t.sent.filter(function(e){return 0===e.indexOf(cachePrefix)}).map(function(e){return e.slice(cachePrefix.length)}),t.abrupt("return",Promise.all(e.map(function(e){var t,n,a;return regeneratorRuntime.async(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,caches.match(this._getMetaRequest(e));case 2:if(t=r.sent){r.next=6;break}return module.exports.uncache(e),r.abrupt("return",!1);case 6:return r.next=9,t.json();case 9:return n=r.sent,a=n.query.pages[Object.keys(n.query.pages)[0]],r.abrupt("return",{title:a.title,extract:a.extract,urlId:a.title.replace(/\s/g,"_")});case 12:case"end":return r.stop()}},null,r)})).then(function(e){return e.filter(function(e){return e})}));case 6:case"end":return t.stop()}},null,this)},uncache:function(e){return caches["delete"](cachePrefix+e)}};


},{"./utils":17,"srcset":14}]},{},[1]);

//# sourceMappingURL=page.js.map